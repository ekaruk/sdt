# Настройка автогенерации заголовков через OpenAI

## Что сделано

Добавлена функция автоматической генерации заголовков вопросов через OpenAI API.

## Как это работает

1. При создании или редактировании вопроса, если поле "Заголовок" пустое, система автоматически генерирует его через OpenAI API
2. Используется модель `gpt-3.5-turbo` для создания краткого заголовка (5-10 слов)
3. Если API недоступен или ключ не настроен, используется fallback: берется первое предложение из текста вопроса

## Настройка

### 1. Получить API ключ OpenAI

1. Зарегистрируйтесь на https://platform.openai.com/
2. Перейдите в раздел API Keys: https://platform.openai.com/api-keys
3. Создайте новый ключ (Create new secret key)
4. Скопируйте ключ (он показывается только один раз!)

### 2. Добавить ключ в переменные окружения

#### Локально (.env файл):
```env
OPENAI_API_KEY=sk-proj-...ваш_ключ...
```

#### На Render.com:
1. Откройте ваш сервис на Render
2. Перейдите в Environment
3. Добавьте переменную:
   - Key: `OPENAI_API_KEY`
   - Value: `sk-proj-...ваш_ключ...`
4. Сохраните и дождитесь перезапуска сервиса

### 3. Пополнить баланс OpenAI

OpenAI API работает по модели pay-as-you-go:
- Стоимость gpt-3.5-turbo: ~$0.0015 за 1000 токенов
- Генерация одного заголовка стоит примерно $0.0001-0.0002
- Рекомендуемый начальный баланс: $5-10

Пополнить баланс можно здесь: https://platform.openai.com/settings/organization/billing/overview

## Использование

### Автоматическая генерация

Заголовок генерируется автоматически когда:
1. Создается новый вопрос с пустым полем "Заголовок"
2. Редактируется вопрос и поле "Заголовок" очищается

### Пример

**Текст вопроса:**
```
Как правильно использовать async/await в Python? 
Я пытаюсь создать асинхронный запрос к API, но получаю ошибку RuntimeError...
```

**Сгенерированный заголовок:**
```
Использование async/await в Python для API запросов
```

## Без API ключа (Fallback)

Если `OPENAI_API_KEY` не настроен, система будет использовать простой алгоритм:
- Берется первое предложение из текста вопроса (до точки или вопросительного знака)
- Обрезается до 100 символов

Пример fallback:
```
Текст: "Как правильно использовать async/await в Python?"
Заголовок: "Как правильно использовать async/await в Python"
```

## Мониторинг использования

Проверить использование API можно на: https://platform.openai.com/usage

## Стоимость

При 100 вопросах в месяц:
- ~$0.01-0.02 в месяц
- Очень экономично для базового использования

## Логи

Генерация заголовка логируется в консоль:
```
[AI Title] Generated: Использование async/await в Python
```

При ошибках также выводятся в консоль:
```
[AI Title] OpenAI API error: ...
[AI Title] Error: ...
```
